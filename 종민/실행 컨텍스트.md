# 실행 컨텍스트

## 자바스크립트 엔진 소스 코드 처리 단계

1. 소스코드 평가

   1. 실행 컨텍스트 생성
   2. 선언문을 보고 식별자 스코프에 등록
   3. this 바인딩도 결정

2. 소스코드 실행
   1. 필요한 정보는 스코프에서 찾는다
   2. 수정 작업이 이루어지면 스코프를 수정한다.

## 실행 컨텍스트

샐행 컨텍스트란 아래 3가지를 하는 친구를 말한다.

1. 스코프를 구분하여 식별자를 등록하고 관리한다.
2. 스코프 체인을 통해 식별자를 검색한다.
3. 실행 중인 스코프 변경 후 되돌아 간다.

위 3가지를 하기 위해 실행 컨텍스트는 두 가지를 가지고 있다.

- 렉시컬 환경
- 실행 컨텍스트 스택

## 실행 컨텍스트 스택

- 실행 컨텍스트 스택은 코드의 실행 순서를 관리한다.
- 실행 컨텍스트 스택의 최상위에 존재하는 실행 컨텍스트는 언제나 현재 실행 중인 코드의 실행 컨텍스트다.

## 렉시컬 환경

렉시컬 환경은 키와 값을 갖는 객체 형태의 스코프（전역, 함수, 블록 스코프）를 생성하여 식별자를 키로 등록하고 식별자에 바인딩된 값을 관리한다.

두 개의 컴포넌트로 이루어져 있다.

- 환경 레코드: 식별자와 바인딩된 값을 관리
- 외부 렉시컬 환경 참조: 상위 렉시컬 환경을 가리킨다.

## 전역 렉시컬 환경

- 환경 레코드
  - 객체 환경 레코드: 전역 객체
  - 선언적 환경 레코드: let, const
  - [[GlobalThisValue]]: window
- 외부 렉시컬 환경 참조: null

## 호이스팅이 발생하는 이유

코드 실행 단계 이전에 실행 컨텍스트가 생성되고 선언문으로 선언된 변수와 함수 등을 실행 컨텍스트에 등록하기 떄문이다.

## 함수 렉시컬 환경

- 환경 레코드
  - arguments,지역 함수 변수
  - [[ThisValue]]
- 외부 렉시컬 환경 참조: 실행 중인 실행 컨텍스트

## 블록 레벨 스코프

블록 렉시컬 환경을 만들어 잠시 실행컨텍스트가 참조하게 한다. 끝나면 다시 이전 렉시컬 환경으로 되돌린다
